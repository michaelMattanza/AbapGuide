```abap 
 CALL FUNCTION 'BAPI_ACC_DOCUMENT_POST'
    EXPORTING
      DOCUMENTHEADER    = DOC_HEADER
    IMPORTING
      OBJ_KEY           = OBJTYP
    TABLES
      ACCOUNTGL         = DOC_ITEM
      ACCOUNTRECEIVABLE = CUSTOMER
      ACCOUNTPAYABLE    = VENDOR
      CURRENCYAMOUNT    = DOC_VALUES
      RETURN            = RETURN.

CALL FUNCTION 'BAPI_TRANSACTION_COMMIT'
      IMPORTING
        RETURN = RETURN.
    COMMIT WORK AND WAIT.
``` 
